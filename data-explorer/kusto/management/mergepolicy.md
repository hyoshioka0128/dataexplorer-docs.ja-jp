---
title: エクステントのマージポリシー-Azure データエクスプローラー |Microsoft Docs
description: この記事では、Azure データエクスプローラーのエクステントのマージポリシーについて説明します。
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 02/19/2020
ms.openlocfilehash: f0398fbc19842b3cce7fe69c8cb61258d0aeaaa6
ms.sourcegitcommit: a562ce255ac706ca1ca77d272a97b5975235729d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/26/2020
ms.locfileid: "83867037"
---
# <a name="extents-merge-policy"></a>エクステントのマージポリシー
マージポリシーでは、Kusto クラスターの[エクステント (データシャード)](../management/extents-overview.md)をマージするかどうか、およびその方法を定義します。

マージ操作には `Merge` 、(インデックスを再構築する) と `Rebuild` (データを完全に reingests する) の2種類があります。

両方の種類の操作で、1つのエクステントが返されます。これにより、ソースエクステントが置き換えられます。

既定では、リビルド操作が優先されます。また、再構築の条件に適合しない残りのエクステントがある場合にのみ、再構築が試行されます。  

*注:*
- *異なる*タグを使用してエクステントにタグを付けると `drop-by` 、マージポリシーが設定されている場合でも、このようなエクステントはマージされません (「[エクステントのタグ付け](../management/extents-overview.md#extent-tagging)」を参照してください)。
- タグの共用体が1M 文字の長さを超えるエクステントは、一緒にマージされません。
- また、データベースの/テーブルの[シャーディングポリシー](./shardingpolicy.md)では、エクステントのマージ方法にも影響があります。

マージポリシーには、次のプロパティが含まれています。

- **RowCountUpperBoundForMerge**:
    - 既定値: 
      - 2020年6月より前に設定されたポリシーの場合は 0 (無制限)。
      - 1600万6月2020開始時に設定されたポリシーの場合。
    - マージされたエクステントの最大許容行数。
    - 再構築ではなく、マージ操作に適用されます。  
- **OriginalSizeMBUpperBoundForMerge**:
    - 既定値は 0 (無制限) です。
    - マージされたエクステントの元の最大許容サイズ (Mb 単位)。
    - 再構築ではなく、マージ操作に適用されます。  
- **MaxExtentsToMerge**:
    - 既定値は100です。
    - 1回の操作でマージするエクステントの最大許容数。
    - マージ操作に適用されます。
- **LoopPeriod**:
    - 既定値は 01:00:00 (1 時間) です。
    - (データ管理サービスによって実行される) マージ/再構築操作の2回連続イテレーションが開始されるまでの最大待機時間。
    - マージ操作と再構築操作の両方に適用されます。
- **Allowrebuild**:
    - 既定値は ' true ' です。
    - 操作を有効にするかどうか `Rebuild` を定義します (この場合、操作よりも優先され `Merge` ます)。
- **Allowmerge**:
    - 既定値は ' true ' です。
    - `Merge`操作が有効かどうかを定義します (この場合、操作より優先されることはあり `Rebuild` ません)。
- **Maxrangeinhours**:
    - 既定値は8です。
    - 2つの異なるエクステントの作成時の間に許容される最大の差 (時間単位)。ただし、マージできるようになります。
    - タイムスタンプは、エクステント作成のものであり、エクステントに含まれる実際のデータには関係しません。
    - マージ操作と再構築操作の両方に適用されます。
    - ベストプラクティスとして、この値は、データベースの/テーブルの[保持ポリシー](./retentionpolicy.md)の*Softdeleteperiod*または[キャッシュポリシー](./cachepolicy.md)の*dataホットスパン*(2 つ目の部分) に関連付けられ、後者の2-3% の間になります。

**`MaxRangeInHours`例**

|最小 (SoftDeletePeriod (保持ポリシー)、Dataホットスパン (キャッシュポリシー))|最大範囲 (時間) (マージポリシー)|
|--------------------------------------------------------------------|---------------------------------|
|7日 (168 時間)                                                  | 4                               |
|14日 (336 時間)                                                 | 8                               |
|30日 (720 時間)                                                 | 18                              |
|60日 (1440 時間)                                               | 36                              |
|90日 (2160 時間)                                               | 60                              |
|180日 (4320 時間)                                              | 120                             |
|365日 (8760 時間)                                              | 250                             |

> [!WARNING]
> エクステントのマージポリシーを変更する前に、Azure データエクスプローラーチームに問い合わせてください。

データベースが作成されると、既定のマージポリシー (前述の既定値を持つポリシー) が設定されます。これは、既定では、データベースで作成されたすべてのテーブルによって継承されます (テーブルレベルで明示的にオーバーライドされていない場合)。

データベースまたはテーブルのマージポリシーを管理できるようにする制御コマンドについては、[こちら](../management/merge-policy.md)を参照してください。
