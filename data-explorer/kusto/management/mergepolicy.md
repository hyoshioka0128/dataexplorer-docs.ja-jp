---
title: エクステント マージ ポリシー - Azure データ エクスプローラー |マイクロソフトドキュメント
description: この記事では、Azure データ エクスプローラーでのエクステント マージ ポリシーについて説明します。
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 02/19/2020
ms.openlocfilehash: 771af22f07a770b0da1196871e9132393524aab9
ms.sourcegitcommit: 47a002b7032a05ef67c4e5e12de7720062645e9e
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/15/2020
ms.locfileid: "81520725"
---
# <a name="extents-merge-policy"></a>エクステントマージポリシー
マージ ポリシーは、Kusto クラスター内[のエクステント (データシャード) を](../management/extents-overview.md)マージするかどうか、およびマージする方法を定義します。

マージ操作には`Merge`、(インデックスを再構築する)と`Rebuild`(データを完全に再取り込む)という 2 つのフレーバーがあります。

どちらの操作の種類も、ソースエクステントを置き換える単一のエクステントで結果を出します。

既定では、再構築操作が優先され、再構築の条件に適合しない範囲が残っている場合にのみ、マージが試行されます。  

*注:*
- *異なる*`drop-by`タグを使用してエクステントにタグを付けると、マージポリシーが設定されている場合でも、そのようなエクステントはマージされません(「[範囲タグ付け](../management/extents-overview.md#extent-tagging)」を参照)。
- タグの和集合が 1M 文字の長さを超えるエクステントは、結合されません。
- データベースの / テーブルの[シャーディング ポリシー](./shardingpolicy.md)は、エクステントをマージする方法にも影響を与えます。

マージ ポリシーには、次のプロパティが含まれます。

- **行カウントアッパーバウンドバインド:**
    - 既定値は 0 です。
    - マージされたエクステントの最大許容行数。
    - 再構築ではなく、マージ操作に適用されます。  
- **マージする :**
    - デフォルトは 100 です。
    - 1 回の操作でマージできるエクステントの最大数。
    - マージ操作に適用されます。
- **ループ期間**:
    - デフォルトは 01:00:00 (1 時間) です。
    - マージ/再構築操作の 2 回連続反復を開始するまでの最大待機時間 (データ管理サービスによって実行されます)。
    - マージ操作とリビルド操作の両方に適用されます。
- **再構築を許可**する :
    - デフォルトは 'true' です。
    - 操作を`Rebuild`有効にするかどうかを定義します (この場合、操作よりも`Merge`優先されます)。
- **マージを許可**する :
    - デフォルトは 'true' です。
    - 操作を`Merge`有効にするかどうかを定義します (この場合、操作よりも`Rebuild`優先されません)。
- **時間数**:
    - デフォルトは 8 です。
    - 2 つの異なるエクステントの作成時間間の許容差 (時間単位) の最大値を指定し、マージできます。
    - タイム・スタンプはエクステント作成のものであり、エクステントに含まれる実際のデータとは関係ありません。
    - マージ操作とリビルド操作の両方に適用されます。
    - この値をデータベースの / テーブルの[保持ポリシー](./retentionpolicy.md)の*SoftDeletePeriod*、または[キャッシュ ポリシー](./cachepolicy.md)の*DataHotSpan* (2 つのうち低い方) と相関付けするのがベスト プラクティスです。

**`MaxRangeInHours`例：**
|min(ソフト削除期間(保持ポリシー)、データホットスパン(キャッシュポリシー))|最大範囲 (マージ ポリシー)
|---|---
|7日間(168時間)| 4
|14日(336時間)| 8
|30日(720時間)| 18
|60日(1,440時間)| 36
|90日(2,160時間)| 60
|180日(4,320時間)| 120
|365日(8,760時間)| 250

> [!WARNING]
> 最初にKustoチームと相談せずにエクステントマージポリシーを変更することはめったに推奨されません。

データベースが作成されると、デフォルトのマージポリシー (上記のデフォルト値を持つポリシー) が設定されます。

データベース/テーブルのマージポリシーを管理できる制御コマンドは[、こちらからご覧いただけます](../management/merge-policy.md)。