---
title: Azure アクティブ ディレクトリ (AAD) 認証 - Azure データ エクスプローラー |マイクロソフトドキュメント
description: この記事では、Azure データ エクスプローラーでの Azure アクティブ ディレクトリ (AAD) 認証について説明します。
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 09/13/2019
ms.openlocfilehash: 637252b91af53198b3ee494309857b2d4b6e6828
ms.sourcegitcommit: 47a002b7032a05ef67c4e5e12de7720062645e9e
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/15/2020
ms.locfileid: "81522935"
---
# <a name="azure-active-directory-aad-authentication"></a>Azure アクティブ ディレクトリ (AAD) 認証

Azure Active Directory (AAD) は、Azure の優先マルチテナント クラウド ディレクトリ サービスであり、セキュリティ プリンシパルの認証や、Microsoft の Active Directory などの他の ID プロバイダーとのフェデレーションに対応できます。

AAD は、さまざまな種類のアプリケーション (Web アプリケーション、Windows デスクトップ アプリケーション、ユニバーサル アプリケーション、モバイル アプリケーションなど) を一様に認証し、Kusto サービスを使用することができます。

AAD は、多くの認証シナリオをサポートしています。
認証中に存在するユーザーがいる場合は、AAD ユーザー認証によって AAD に対してユーザーを認証する必要があります。
対話的にユーザーがいない場合でも、サービスで Kusto を使用する必要がある場合があります。 このような場合は、「AAD アプリケーション認証」で説明されているように、アプリケーション シークレットを使用してアプリケーションを認証する必要があります。

次の認証方法は、一般的に 、.NET ライブラリを含む Kusto でサポートされています。

* 対話型ユーザー認証 - このモードでは、必要に応じて、ログオン UI がポップアップする対話が必要です。
* Kusto 用に以前に発行された既存の AAD トークンを使用したユーザー認証
* AppID と共有シークレットを使用したアプリケーション認証
* ローカルにインストールされた X.509v2 証明書またはインライン証明書を使用したアプリケーション認証
* Kusto 用に以前発行された既存の AAD トークンを使用したアプリケーション認証
* 別のリソースに対して発行された AAD トークンを使用したユーザー認証またはアプリケーション認証 (そのリソースと Kusto の間に信頼が存在する場合)

ガイダンスと例については[、Kusto 接続文字列](../../api/connection-strings/kusto.md)リファレンスを参照してください。

## <a name="user-authentication"></a>ユーザー認証

ユーザー認証は、ユーザーが AAD (または、ADFS などの、AAD と連携する ID プロバイダー) に資格情報を提示すると実行されて、Kusto サービスに提示できるセキュリティ トークンを取得します。 Kusto サービスは、セキュリティ トークンの取得方法は考慮せず、トークンが有効かどうか、および AAD (または連携している IdP) によってどのような情報がそこに入れられているかを考慮します。

クライアント側では、Kusto は、AAD クライアント ライブラリ ADAL または同様のコードがユーザーに資格情報の入力を要求する対話型認証をサポートしています。 また、Kusto を使用するアプリケーションが有効なユーザー トークンを取得して提示する、トークンベースの認証もサポートしています。 最後に、Kusto を使用するアプリケーションが他のサービス (Kusto 以外) の有効なユーザー トークンを取得するシナリオをサポートしています。ただし、そのリソースと Kusto との間に信頼関係があることが条件になります。

[Kusto クライアントライブラリを使用](../../api/connection-strings/kusto.md)して、AAD を kusto に認証する方法の詳細については、kusto 接続文字列に関する説明を参照してください。

## <a name="application-authentication"></a>アプリケーション認証

要求が特定のユーザーに関連付けられていない場合、または資格情報を入力できるユーザーがいない場合は、AAD アプリケーション認証フローを使用できます。 このフローでは、アプリケーションはいくつかの秘密情報を提示することで、AAD (または連携している IdP) に対して認証を行います。 次のシナリオは、さまざまな Kusto クライアントでサポートされています。

* ローカルにインストールされた X.509v2 証明書を使用したアプリケーション認証。
* クライアント ライブラリにバイト ストリームとして提供された X.509v2 証明書を使用したアプリケーション認証。
* AAD アプリケーション ID と AAD アプリケーション キーを使用したアプリケーション認証 (アプリケーションに対するユーザー名/パスワードの認証に相当)。
* 以前に取得した有効な AAD トークン (Kusto に対して発行されたもの) を使用したアプリケーション認証。
* 以前に取得した、他のリソースに対して発行された有効な AAD トークンを使用したアプリケーション認証 (ただし、そのリソースと Kusto との間に信頼関係があることが条件になります)。

## <a name="aad-server-application-permissions"></a>AAD サーバー アプリケーションのアクセス許可

一般的なケースでは、AAD Server アプリケーションは複数のアクセス許可 (読み取り専用アクセス許可、ライター読み取りアクセス許可など) を定義でき、AAD クライアント アプリケーションは承認トークンを要求するときに必要なアクセス許可を決定できます。 トークン取得の一環として、ユーザーは、これらのアクセス許可を持つ権限を持つユーザーの代理として AAD クライアント アプリケーションを承認するように求められます。 ユーザーが承認した場合、これらのアクセス許可は、AAD クライアント アプリケーションに発行されるトークンのスコープ クレームに表示されます。



AAD クライアント アプリケーションは、ユーザーに "アクセス クスト" アクセス許可を要求するように構成されています (AAD は "リソース所有者" と呼びます)。

## <a name="kusto-client-sdk-as-an-aad-client-application"></a>AAD クライアント アプリケーションとしての Kusto クライアント SDK

Kusto クライアント ライブラリは、ADAL (AAD クライアント ライブラリ) を呼び出して、Kusto と通信するためのトークンを取得するときに、次の情報を提供します。

1. 呼び出し元から受信した AAD テナント
2. AAD クライアント アプリケーション ID
3. AAD クライアント リソース ID
4. AAD ReplyUrl (認証が正常に完了した後に AAD サービスがリダイレクトする URL。ADAL は、このリダイレクトをキャプチャし、そこから認証コードを抽出します)。
5. クラスター URI (''https://Cluster-and-region.kusto.windows.net)

ADAL から Kusto クライアント ライブラリに返されるトークンには、対象ユーザーとして Kusto AAD Server アプリケーションがあり、スコープとして "アクセス クスト" アクセス許可があります。

## <a name="authenticating-with-aad-programmatically"></a>プログラムで AAD を使用した認証

次の記事では、プログラムで AAD を使用して Kusto に対して認証を行う方法について説明します。

* [AAD アプリケーションをプロビジョニングする方法](./how-to-provision-aad-app.md)
* [AAD 認証を実行する方法](./how-to-authenticate-with-aad.md)

