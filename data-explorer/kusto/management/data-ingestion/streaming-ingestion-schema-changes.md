---
title: ストリーミングインジェストとスキーマ変更-Azure データエクスプローラー
description: この記事では、Azure データエクスプローラーでのストリーミングインジェストを使用したスキーマ変更の処理のオプションについて説明します。
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 05/20/2020
ms.openlocfilehash: f1ab3d012be7751eba33447b325748859509af00
ms.sourcegitcommit: 8e097319ea989661e1958efaa1586459d2b69292
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/15/2020
ms.locfileid: "84784567"
---
# <a name="streaming-ingestion-and-schema-changes"></a>ストリーミング インジェストとスキーマ変更

## <a name="background"></a>バックグラウンド

クラスターノードは、ストリーミングインジェストを介してデータを受信するデータベースのスキーマをキャッシュします。 このプロセスでは、クラスターリソースのパフォーマンスと使用率が最適化されますが、スキーマが変更されると、伝達の遅延が発生する可能性があります。

スキーマ変更の例を次に示します。

* データベースとテーブルの作成と削除
* テーブルの列の追加、削除、再入力、または名前の変更
* 事前に作成されたインジェストマッピングの追加または削除
* ポリシーの追加、削除、または変更

スキーマの変更とストリーミングインジェストフローが一貫性されている場合、一部のストリーミングインジェスト要求が失敗する可能性があります。 エラーには、スキーマ関連のエラー、または不完全なデータまたはテーブルへのデータの挿入が含まれる場合があります。
カスタムインジェストアプリケーションを実装する場合は、制限された時間内に再試行を実行するか、キューに置かれたインジェストメソッドを使用して失敗した要求からデータを再ルーティングすることによって、スキーマ関連のエラーを処理することを強くお勧めします。

## <a name="clearing-the-schema-cache"></a>スキーマキャッシュのクリア

クラスターノードのスキーマキャッシュを明示的にクリアして、伝達の遅延の影響を軽減します。
[ストリーミングインジェスト管理コマンドのスキーマキャッシュのクリア](clear-schema-cache-command.md)を使用して、スキーマキャッシュをクリアします。
ストリーミングインジェストフローとスキーマ変更が調整されている場合は、障害とそれに関連するデータの歪みを完全に排除できます。 

**コーディネートフローの例:**

1. ストリーミングの取り込みを中断します。
1. 未処理のストリーミングインジェスト要求がすべて完了するまで待ち>
1. スキーマの変更を行います。
1. 1つまたは複数 `.clear cache streaming ingestion` のスキーマコマンドを発行します。 
    * 成功するまで繰り返し、コマンドの出力のすべての行が成功したことを示します。
1. ストリーミングの取り込みを再開します。

> [!NOTE]
> クリアキャッシュストリーミング取り込みスキーマコマンドを頻繁に使用すると、ストリーミングインジェストのパフォーマンスに悪影響を及ぼす可能性があります。
